<!DOCTYPE html>
<html lang="en">
{{ template "head" . }}
<body>

<div class="container-fluid">
    {{ $root := . }}
    {{ $devs := .Devices }}
    {{ $rgbModes := .Device.RGBModes }}
    {{ $emulationModes := .Device.ThumbStickModes }}
    {{ $macros := .Macros }}
    {{ $temperatures := .Temperatures }}
    {{ $device := .Device }}
    {{ $rgb := .Rgb }}
    {{ $deviceProfile := .Device.DeviceProfile }}
    <input type="hidden" id="deviceId" name="deviceId" value="{{ $device.Serial }}">
    <input type="hidden" id="zones" name="zones" value="{{ $device.ZoneAmount }}">

    <div class="row">
        <!-- Sidebar -->
        {{ template "sidebar" . }}

        <!-- Main -->
        <main class="main-content p-4">
            <!-- Temperature bar -->
            {{ if .Dashboard.TemperatureBar }}
            {{ template "temperature-bar" . }}
            {{ end }}

            {{ if eq .Device.Connected false }}
            {{ template "404-no-device" . }}
            {{ else }}

            <!-- SCUF ENVISION PRO -->
            <div class="row g-4 mb-4 align-items-start">
                <div class="col-md-2">
                    <div class="card system-card text-center">
                        <div class="card-header">
                            {{ .Device.Product }}
                        </div>
                        <div class="card-body">
                            <div class="settings-list">
                                <!-- Firmware -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtFirmware" }}</span>
                                    <span class="meta-value">{{ .Device.Firmware }}</span>
                                </div>

                                <!-- User profile -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtProfile" }}</span>
                                    <label for="profiles">
                                        <select id="profiles" class="system-select auto-width compact userProfile" name="userProfile">
                                            {{ range $key, $profile := $device.UserProfiles }}
                                            {{ if $profile.Active }}
                                            <option value="{{ $key }}" selected>{{ $key }}</option>
                                            {{ else }}
                                            <option value="{{ $key }}">{{ $key }}</option>
                                            {{ end }}
                                            {{ end }}
                                        </select>
                                    </label>
                                </div>

                                <!-- Brightness -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtBrightness" }}</span>
                                    <div class="system-slider no-padding-top">
                                        <label for="brightnessSlider">
                                            <input type="range" id="brightnessSlider" name="brightnessSlider" min="0" max="100" value="{{ $deviceProfile.BrightnessSlider }}" step="1">
                                        </label>
                                        <div class="slider-value" id="brightnessSliderValue">{{ $deviceProfile.BrightnessSlider }} %</div>
                                    </div>
                                </div>

                                <!-- RGB Profile -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtRgb" }}</span>
                                    <label for="rgbProfile">
                                        <select id="rgbProfile" class="system-select auto-width compact mouseRgbProfile" name="mouseRgbProfile">
                                            {{ range $key, $mode := $rgbModes }}
                                            {{ if eq $mode $device.DeviceProfile.RGBProfile }}
                                            <option value="0;{{ $mode }}" selected>{{ $mode }}</option>
                                            {{ else }}
                                            <option value="0;{{ $mode }}">{{ $mode }}</option>
                                            {{ end }}
                                            {{ end }}
                                        </select>
                                    </label>
                                </div>

                                {{ if eq .Device.Usb false }}
                                <!-- Sleep -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtSleepTimer" }}</span>
                                    <label for="sleepTimer">
                                        <select id="sleepTimer" class="system-select auto-width compact controllerSleepModes" name="sleepModes">
                                            {{ range $key, $sleepMode := $device.SleepModes }}
                                            <option value="{{ $key }}" {{ if eq $device.DeviceProfile.SleepMode $key }} selected {{ end }}>{{ $sleepMode }}</option>
                                            {{ end }}
                                        </select>
                                    </label>
                                </div>
                                {{ end }}

                                <!-- Delete user profile -->
                                <div class="settings-row">
                                    <span class="settings-label text-ellipsis">{{ .Lang "txtDeleteProfile" }}</span>
                                    <label for="deleteUserProfiles">
                                        <select id="deleteUserProfiles" class="system-select auto-width compact deleteUserProfiles" name="deleteUserProfiles">
                                            <option value="none">None</option>
                                            {{ range $key, $profile := $device.UserProfiles }}
                                            {{ if $profile.Active }}
                                            {{ continue }}
                                            {{ else }}
                                            <option value="{{ $key }}">{{ $key }}</option>
                                            {{ end }}
                                            {{ end }}
                                        </select>
                                    </label>
                                </div>

                                <!-- Save profile -->
                                <div class="settings-row">
                                    <button class="system-button center saveUserProfile">{{ .Lang "txtSaveUserProfile" }}</button>
                                    <button class="system-button danger center deleteUserProfile">{{ .Lang "txtDeleteProfile" }}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="row g-4 mb-4 align-items-stretch">
                        <!-- Zone Colors -->
                        <div class="col-md-4">
                            <div class="card system-card text-center" data-info="1">
                                <div class="card-header">
                                    {{ .Lang "txtControllerLEDs" }}
                                </div>
                                <div class="card-body">
                                    <div class="settings-list">
                                        {{ range $key, $zone := $device.DeviceProfile.ZoneColors }}
                                        <div class="settings-row">
                                            <span class="settings-label text-ellipsis">{{ $root.Lang "txtZone" }}: {{ $zone.Name }}</span>
                                            <div class="system-color compact">
                                                <label>
                                                    <input type="color" id="zoneColor{{ $key }}" value="{{ $zone.Color.Hex }}">
                                                </label>
                                            </div>
                                        </div>
                                        {{ end }}
                                    </div>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button" id="saveZoneColors">{{ .Lang "txtSaveZoneColors" }}</button>
                                </div>
                            </div>
                        </div>

                        <!-- Left Vibration Module -->
                        <div class="col-md-4">
                            <div class="card system-card" data-info="1">
                                <div class="card-header">
                                    {{ .Lang "txtLeftVibrationModule" }}
                                </div>
                                <div class="card-body">
                                    <div class="settings-list">
                                        <div class="settings-row settings-row-80-20">
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="leftVibrationValue"
                                                            name="leftVibrationValue"
                                                            class="system-slider-input"
                                                            min="0"
                                                            max="100"
                                                            value="{{ $deviceProfile.LeftVibrationValue }}"
                                                            step="1"
                                                            data-value-target="#leftVibrationValueText"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="leftVibrationValueText">{{ $deviceProfile.LeftVibrationValue }} %</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button" id="btnSaveLeftVibrationValue">{{ .Lang "txtSave" }}</button>
                                </div>
                            </div>
                        </div>

                        <!-- Right Vibration Module -->
                        <div class="col-md-4">
                            <div class="card system-card text-center" data-info="1">
                                <div class="card-header">
                                    {{ .Lang "txtRightVibrationModule" }}
                                </div>
                                <div class="card-body">
                                    <div class="settings-list">
                                        <div class="settings-row settings-row-80-20">
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="rightVibrationValue"
                                                            name="rightVibrationValue"
                                                            class="system-slider-input"
                                                            min="0"
                                                            max="100"
                                                            value="{{ $deviceProfile.RightVibrationValue }}"
                                                            step="1"
                                                            data-value-target="#rightVibrationValueText"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="rightVibrationValueText">{{ $deviceProfile.RightVibrationValue }} %</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button" id="btnSaveRightVibrationValue">{{ .Lang "txtSave" }}</button>
                                </div>
                            </div>
                        </div>

                        <!-- Left Thumbstick Emulation -->
                        <div class="col-md-6">
                            <div class="card system-card text-center" data-info="1">
                                <div class="card-header">
                                    {{ .Lang "txtLeftThumbstickEmulation" }}
                                </div>
                                <div class="card-body">
                                    <div class="settings-list">
                                        <div class="settings-row">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtEmulationMode" }}</span>
                                            <label for="leftThumbStickEmulationMode">
                                                <select id="leftThumbStickEmulationMode" class="system-select auto-width compact leftThumbStickEmulationMode" name="leftThumbStickEmulationMode">
                                                    {{ range $key, $mode := $emulationModes }}
                                                    <option value="{{ $key }}" {{ if eq $key $device.DeviceProfile.LeftThumbStickMode }} selected {{ end}}>{{ $mode }}</option>
                                                    {{ end }}
                                                </select>
                                            </label>
                                        </div>

                                        <div class="settings-row settings-row-30-50-20">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtSensitivityX" }}</span>
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="leftThumbStickSensitivityValueX"
                                                            name="leftThumbStickSensitivityValueX"
                                                            class="system-slider-input-no-percent"
                                                            min="5"
                                                            max="50"
                                                            value="{{ $deviceProfile.LeftThumbStickSensitivityX }}"
                                                            step="1"
                                                            data-value-target="#leftThumbStickSensitivityX"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="leftThumbStickSensitivityX">{{ $deviceProfile.LeftThumbStickSensitivityX }}</div>
                                        </div>

                                        <div class="settings-row settings-row-30-50-20">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtSensitivityY" }}</span>
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="leftThumbStickSensitivityValueY"
                                                            name="leftThumbStickSensitivityValueY"
                                                            class="system-slider-input-no-percent"
                                                            min="5"
                                                            max="50"
                                                            value="{{ $deviceProfile.LeftThumbStickSensitivityY }}"
                                                            step="1"
                                                            data-value-target="#leftThumbStickSensitivityY"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="leftThumbStickSensitivityY">{{ $deviceProfile.LeftThumbStickSensitivityY }}</div>
                                        </div>

                                        <div class="settings-row">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtInvertYAxis" }}</span>
                                            <label class="system-toggle compact">
                                                <input type="checkbox" id="leftThumbStickInvertY" {{ if $deviceProfile.LeftThumbStickInvertY }} checked {{ end }}>
                                                <span class="toggle-track"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button" id="btnSaveLeftThumbstick">{{ .Lang "txtSave" }}</button>
                                </div>
                            </div>
                        </div>

                        <!-- Right Thumbstick Emulation -->
                        <div class="col-md-6">
                            <div class="card system-card text-center" data-info="1">
                                <div class="card-header">
                                    {{ .Lang "txtRightThumbstickEmulation" }}
                                </div>
                                <div class="card-body">
                                    <div class="settings-list">
                                        <div class="settings-row">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtEmulationMode" }}</span>
                                            <label for="rightThumbStickEmulationMode">
                                                <select id="rightThumbStickEmulationMode" class="system-select auto-width compact rightThumbStickEmulationMode" name="rightThumbStickEmulationMode">
                                                    {{ range $key, $mode := $emulationModes }}
                                                    <option value="{{ $key }}" {{ if eq $key $device.DeviceProfile.RightThumbStickMode }} selected {{ end}}>{{ $mode }}</option>
                                                    {{ end }}
                                                </select>
                                            </label>
                                        </div>

                                        <div class="settings-row settings-row-30-50-20">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtSensitivityX" }}</span>
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="rightThumbStickSensitivityValueX"
                                                            name="rightThumbStickSensitivityValueX"
                                                            class="system-slider-input-no-percent"
                                                            min="5"
                                                            max="50"
                                                            value="{{ $deviceProfile.RightThumbStickSensitivityX }}"
                                                            step="1"
                                                            data-value-target="#RightThumbStickSensitivityX"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="rightThumbStickSensitivityX">{{ $deviceProfile.RightThumbStickSensitivityX }}</div>
                                        </div>

                                        <div class="settings-row settings-row-30-50-20">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtSensitivityY" }}</span>
                                            <div class="system-slider no-padding-top">
                                                <label for="brightnessSlider" class="full-width">
                                                    <input
                                                            type="range"
                                                            id="rightThumbStickSensitivityValueY"
                                                            name="rightThumbStickSensitivityValueY"
                                                            class="system-slider-input-no-percent"
                                                            min="5"
                                                            max="50"
                                                            value="{{ $deviceProfile.RightThumbStickSensitivityY }}"
                                                            step="1"
                                                            data-value-target="#rightThumbStickSensitivityY"
                                                    />
                                                </label>
                                            </div>
                                            <div class="slider-value" id="rightThumbStickSensitivityY">{{ $deviceProfile.RightThumbStickSensitivityY }}</div>
                                        </div>

                                        <div class="settings-row">
                                            <span class="settings-label text-ellipsis">{{ .Lang "txtInvertYAxis" }}</span>
                                            <label class="system-toggle compact">
                                                <input type="checkbox" id="rightThumbStickInvertY" {{ if $deviceProfile.RightThumbStickInvertY }} checked {{ end }}>
                                                <span class="toggle-track"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button" id="btnSaveRightThumbstick">{{ .Lang "txtSave" }}</button>
                                </div>
                            </div>
                        </div>

                        <!-- Analog settings -->
                        {{ range $key, $leftTsSettings := $deviceProfile.AnalogData }}

                        {{ $headerText := "" }}
                        {{ if eq $key 0 }}
                            {{ $headerText = $root.Lang "txtLeftThumbstick" }}
                        {{ else if eq $key 1 }}
                            {{ $headerText = $root.Lang "txtRightThumbstick" }}
                        {{ else if eq $key 2 }}
                            {{ $headerText = $root.Lang "txtLeftTrigger" }}
                        {{ else if eq $key 3 }}
                            {{ $headerText = $root.Lang "txtRightTrigger" }}
                        {{ end }}

                        <div class="col-md-6">
                            <div class="card system-card text-center" data-info="1">
                                <div class="card-header">
                                    {{ $headerText }}
                                </div>
                                <div class="card-body no-bottom-padding">
                                    <div class="settings-list">
                                        <canvas id="graph_{{ $key }}" style="width: 100%; height: 300px; display: block;"></canvas>
                                    </div>
                                </div>

                                <div class="card-body text-left">
                                    <button class="system-button secondary btnDataCurvePreset" data-info="{{ $key }};0">{{ $root.Lang "txtLinear" }}</button>
                                    <button class="system-button secondary btnDataCurvePreset" data-info="{{ $key }};1">{{ $root.Lang "txtDynamic" }}</button>
                                    <button class="system-button secondary btnDataCurvePreset" data-info="{{ $key }};2">{{ $root.Lang "txtExponential" }}</button>
                                    <button class="system-button secondary btnDataCurvePreset" data-info="{{ $key }};3">{{ $root.Lang "txtAggressive" }}</button>
                                </div>

                                <div class="card-footer card-footer-left">
                                    <button class="system-button btnSaveAnalogSettings" id="btnSaveAnalogSettings_{{ $key }}" data-info="{{ $key }}">{{ $root.Lang "txtSave" }}</button>
                                </div>
                            </div>
                        </div>
                        {{ end }}
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="card system-card text-center">
                        <table class="dataTable text-sm">
                            <!-- Header -->
                            <thead>
                            <tr>
                                <th>{{ .Lang "txtKeyAssignment" }}</th>
                                <th>
                                    Default
                                    <i style="cursor: pointer;" class="bi bi-info-circle-fill svg-icon svg-icon-sm svg-icon-heavy defaultInfoToggle"></i>
                                </th>
                                <th>
                                    {{ .Lang "txtPressAndHold" }}
                                    <i style="cursor: pointer;" class="bi bi-info-circle-fill svg-icon svg-icon-sm svg-icon-heavy pressAndHoldInfoToggle"></i>
                                </th>
                                <th>
                                    {{ .Lang "txtOnRelease" }}
                                    <i style="cursor: pointer;" class="bi bi-info-circle-fill svg-icon svg-icon-sm svg-icon-heavy onReleaseInfoToggle"></i>
                                </th>
                                <th>{{ .Lang "txtAssignmentType" }}</th>
                                <th>{{ .Lang "txtAssignmentKey" }}</th>
                                <th></th>
                            </tr>
                            </thead>

                            <!-- Body -->
                            <tbody>
                            {{ range $key, $value := $device.KeyAssignment }}
                            {{ if eq $key 1 }}
                            {{ continue }}
                            {{ end }}
                            <tr>
                                <td class="key-assignments">{{ $value.Name }}</td>
                                <td>
                                    <label class="system-toggle compact">
                                        <input type="checkbox" id="default_{{ $key }}" {{ if $value.Default }} checked {{ end }}>
                                        <span class="toggle-track"></span>
                                    </label>
                                </td>
                                <td>
                                    <label class="system-toggle compact">
                                        <input type="checkbox" id="pressAndHold_{{ $key }}" {{ if $value.ActionHold }} checked {{ end }}>
                                        <span class="toggle-track"></span>
                                    </label>
                                </td>
                                <td>
                                    <label class="system-toggle compact">
                                        <input type="checkbox" id="onRelease_{{ $key }}" {{ if $value.OnRelease }} checked {{ end }}>
                                        <span class="toggle-track"></span>
                                    </label>
                                </td>
                                <td>
                                    <select id="keyAssignmentType_{{ $key }}" class="system-select compact full-width keyAssignmentType">
                                        {{ range $k, $v := $device.KeyAssignmentTypes }}
                                        {{ if eq $value.ActionType $k }}
                                        <option value="{{ $k }}" selected>{{ $v }}</option>
                                        {{ else }}
                                        <option value="{{ $k }}">{{ $v }}</option>
                                        {{ end }}
                                        {{ end }}
                                    </select>
                                </td>
                                <td>
                                    <select id="keyAssignmentValue_{{ $key }}" class="system-select compact full-width">
                                        {{ if $value.IsMacro }}
                                        {{ range $k, $v := $macros }}
                                        <option value="{{ $k }}" {{ if eq $value.ActionCommand $k }}selected{{ end }}>{{ $v.Name }}</option>
                                        {{ end }}
                                        {{ else }}
                                        {{ range $k, $v := $device.InputActions }}
                                        <option value="{{ $k }}" {{ if eq $value.ActionCommand $k }}selected{{ end }}>{{ $v.Name }}</option>
                                        {{ end }}
                                        {{ end }}
                                    </select>
                                </td>
                                <td style="text-align: right;">
                                    <button class="system-button saveKeyAssignment" data-info="{{ $key }}">
                                        <span>{{ $root.Lang "txtSave" }}</span>
                                    </button>
                                </td>
                            </tr>
                            {{ end }}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {{ end }}
        </main>
    </div>
</div>
<script src="/static/js/overview.js"></script>
<script src="/static/js/controller.js"></script>
<script src="/static/js/sidebar.js"></script>
{{ if .Dashboard.TemperatureBar }}
<script src="/static/js/temperature-bar.js"></script>
{{ end }}
</body>
</html>
